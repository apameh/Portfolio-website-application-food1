<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اپلیکیشن سفارش آنلاین غذا با تخفیف</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f8;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 20px;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .filter {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter select, .filter input {
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        .products {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .product-card {
            background: #fff;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .product-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .product-card h3 {
            margin: 10px 0 5px 0;
            font-size: 16px;
        }

        .product-card p {
            margin: 5px 0;
            font-weight: bold;
            color: #007bff;
        }

        .product-card input {
            width: 50px;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            text-align: center;
        }

        .product-card button {
            margin-top: 8px;
            padding: 8px 12px;
            border: none;
            background-color: #28a745;
            color: white;
            border-radius: 6px;
            cursor: pointer;
        }

        .product-card button:hover {
            background-color: #218838;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        table th, table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        table th {
            background-color: #f0f0f0;
        }

        .total {
            text-align: right;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .checkout {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .checkout input {
            flex: 1 1 30%;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        .submit-btn {
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }

        .submit-btn:hover {
            background-color: #0056b3;
        }

        .success-message {
            display: none;
            color: green;
            text-align: center;
            font-weight: bold;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>اپلیکیشن سفارش آنلاین غذا با تخفیف</h2>

        <div class="filter">
            <select id="filterType">
                <option value="all">همه محصولات</option>
                <option value="food">غذا</option>
                <option value="drink">نوشیدنی</option>
                <option value="dessert">دسر</option>
            </select>
            <input type="text" id="couponCode" placeholder="کد تخفیف">
            <button id="applyCoupon">اعمال تخفیف</button>
        </div>

        <div class="products" id="productList">
            <!-- محصولات -->
        </div>

        <table id="cartTable">
            <thead>
                <tr>
                    <th>نام محصول</th>
                    <th>قیمت واحد (تومان)</th>
                    <th>تعداد</th>
                    <th>جمع (تومان)</th>
                    <th>حذف</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <div class="total" id="total">جمع کل: 0 تومان</div>

        <div class="checkout">
            <input type="text" id="customerName" placeholder="نام شما">
            <input type="tel" id="customerPhone" placeholder="شماره تلفن">
        </div>

        <button class="submit-btn" id="submitOrder">ثبت سفارش</button>
        <div class="success-message" id="successMessage">سفارش شما با موفقیت ثبت شد!</div>
    </div>

    <script>
        const products = [
            {name:"پیتزا", type:"food", price:120000, img:"https://via.placeholder.com/150?text=Pizza"},
            {name:"برگر", type:"food", price:80000, img:"https://via.placeholder.com/150?text=Burger"},
            {name:"سوشی", type:"food", price:150000, img:"https://via.placeholder.com/150?text=Sushi"},
            {name:"پاستا", type:"food", price:90000, img:"https://via.placeholder.com/150?text=Pasta"},
            {name:"کولا", type:"drink", price:15000, img:"https://via.placeholder.com/150?text=Cola"},
            {name:"آبمیوه", type:"drink", price:20000, img:"https://via.placeholder.com/150?text=Juice"},
            {name:"بستنی", type:"dessert", price:30000, img:"https://via.placeholder.com/150?text=Icecream"},
            {name:"کیک", type:"dessert", price:40000, img:"https://via.placeholder.com/150?text=Cake"}
        ];

        const productList = document.getElementById('productList');
        const filterType = document.getElementById('filterType');
        const cartTableBody = document.querySelector('#cartTable tbody');
        const totalDisplay = document.getElementById('total');
        const submitOrder = document.getElementById('submitOrder');
        const successMessage = document.getElementById('successMessage');
        const customerName = document.getElementById('customerName');
        const customerPhone = document.getElementById('customerPhone');
        const couponInput = document.getElementById('couponCode');
        const applyCoupon = document.getElementById('applyCoupon');

        let cart = [];
        let discount = 0;

        function displayProducts(filter="all") {
            productList.innerHTML = '';
            const filtered = filter === "all" ? products : products.filter(p => p.type === filter);
            filtered.forEach((p,index)=>{
                const card = document.createElement('div');
                card.classList.add('product-card');
                card.innerHTML = `
                    <img src="${p.img}" alt="${p.name}">
                    <h3>${p.name}</h3>
                    <p>${p.price.toLocaleString()} تومان</p>
                    <input type="number" min="1" value="1" id="qty${index}">
                    <button data-index="${index}">افزودن به سبد</button>
                `;
                productList.appendChild(card);
            });

            document.querySelectorAll('.product-card button').forEach(btn=>{
                btn.addEventListener('click', e=>{
                    const index = btn.dataset.index;
                    const qty = parseInt(document.getElementById(`qty${index}`).value||1);
                    if(qty<=0){ alert("تعداد صحیح وارد کنید"); return; }
                    cart.push({...products[index], qty});
                    updateCartTable();
                });
            });
        }

        function updateCartTable() {
            cartTableBody.innerHTML = '';
            let total = 0;
            cart.forEach((item,index)=>{
                const row = document.createElement('tr');
                const itemTotal = item.price*item.qty;
                total += itemTotal;
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.price.toLocaleString()}</td>
                    <td>${item.qty}</td>
                    <td>${itemTotal.toLocaleString()}</td>
                    <td><button data-index="${index}" style="padding:4px 8px;background:red;color:white;border:none;border-radius:4px;cursor:pointer;">حذف</button></td>
                `;
                cartTableBody.appendChild(row);
            });
            // حذف محصول
            document.querySelectorAll('#cartTable tbody button').forEach(btn=>{
                btn.addEventListener('click', e=>{
                    const idx = btn.dataset.index;
                    cart.splice(idx,1);
                    updateCartTable();
                });
            });

            // اعمال تخفیف
            if(discount>0){
                total = total - Math.floor(total*discount/100);
            }

            totalDisplay.textContent = `جمع کل: ${total.toLocaleString()} تومان`;
        }

        filterType.addEventListener('change', ()=>displayProducts(filterType.value));

        applyCoupon.addEventListener('click', ()=>{
            const code = couponInput.value.trim();
            if(code === "DISCOUNT10") discount = 10;
            else if(code === "DISCOUNT20") discount = 20;
            else { discount=0; alert("کد تخفیف معتبر نیست"); }
            updateCartTable();
        });

        submitOrder.addEventListener('click', ()=>{
            if(!customerName.value.trim() || !customerPhone.value.trim()){
                alert('لطفاً نام و شماره تلفن خود را وارد کنید.');
                return;
            }
            if(cart.length===0){
                alert("سبد خرید شما خالی است");
                return;
            }
            successMessage.style.display = 'block';
            cart=[];
            discount=0;
            couponInput.value='';
            updateCartTable();
            customerName.value='';
            customerPhone.value='';
        });

        displayProducts();
    </script>
</body>
</html>
